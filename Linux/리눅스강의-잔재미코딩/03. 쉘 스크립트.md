> https://www.fun-coding.org/



### 3. 쉘 스크립트



#### 쉘 스크립트

* 쉘을 사용하여 프로그래밍 가능.
* 서버 작업 자동화를 위해 기본적으로 익혀둘 필요가 있음.
* 기본 명령어를 기반으로 몇 문법이 추가된 형태.
* 일반적인 프로그래밍 언어와 달리 간단하고, 쉽게 응용 가능.



#### 기본 문법

* 쉘 스크립트는 파일로 작성 후, 파일을 실행
* 파일의 가장 윗 라인은 "#! /bin/bash" 로 시작
* 쉘 스크립트 파일은 실행 권한을 가지고 있어야 함
* '파일이름.sh' 형태로 파일 이름을 작성함



#### 주석

```shell
# 주석은 #을 맨 앞에 넣음으로써 사용한다.
# I am comment!
```



#### 변수

* 선언
  * `변수명=데이터`
  * 이때, 띄어쓰기는 허용하지 않는다.
* 사용
  * `$변수명`으로 사용됨

```shell
name='cutyapple'
age=18

echo "My name is $name"
echo "My age is $age"

------result------

My name is cutyapple
My age is 18
```



#### 배열

* 선언
  * `변수명=(데이터1 데이터2 데이터3)`
* 사용
  * `${변수명[인데스번호]}`

```shell
fruit=("apple", "banana", "carrot")
echo ${fruit[0]}	# fruit 배열의 첫 번째 인덱스 출력
echo ${fruit[@]}	# fruit 배열의 모든 데이터 출력
echo ${fruit[*]}	# fruit 배열의 모든 데이터 출력
echo ${#fruit[@]}	# fruit 배열의 크기 출력
```

* 원소 추가
  * `+=` 연산자를 사용

```shell
fruit=("apple", "banana", "carrot")
fruit+=("mango")

for i in ${fruit[@]}
do
	echo $i
done
```

* 원소 삭제
  * `/`를 사용해 해당 문자열 부분이 있으면 삭제함
  * `unset`을 이용하여 삭제할 수도 있음

```shell
arr=(1, 2, 3)
num=2
arr=("${arr[@]/num}")
for i in ${arr[@]}; do
	echo $i
done
```





#### 사전에 정의된 지역 변수

```shell
$$ : 쉘의 프로세스 번호
$0 : 쉘스크립트 이름
$1 ~ $9 : 명령줄 인수
$* : 모든 명령줄 인수리스트
$# : 인수의 개수
```



#### 연산자

* expr : 숫자 계산
* expr를  사용하는 경우, 역작은 따옴표(`)를 사용해야 함. 
* 연산자 *와 괄호() 앞에는 역슬래스(\\)와 같이 사용해야 함.
* 연산자와 숫자, 변수, 기호 사이에는 space를 넣어야 함.

```shell
num=`expr \(2\*3\) + 4 / 2`
echo $num
----------result-----------
8
```



#### 조건

* 조건 작성이 다른 프로그래밍 언어와 달리 가독성이 현저히 떨어짐.
* 문자 비교

```shell
문자1 == 문자2		# 문자1과 문자2가 일치
문자1 != 문자2		# 문자1과 문자2가 불일치
-z 문자			# 문자가 null이면 참
-n 문자			# 문자가 null이 아니면 참
문자 == 패턴		# 문자열이 패턴과 일치
문자 != 패턴		# 문자열이 패턴과 불일치
```

* 수치 비교 ( <. > 는 if 조건시 [[]] 를 넣는 경우 정상 동작하기도 하지만, 기본적으로 다음 문법을 사용하는 것을 권장함)

```shell
값1 -eq 값2		# 값이 같음 (equal)
값1 -ne 값2		# 값이 같지 않음 (not equal)
값1 -lt 값2		# 값1이 값2보다 작음 (less than)
값1 -le 값2		# 값1이 값2보다 작거나 같음 (less or equal)
값1 -gt 값2		# 값1이 값2보다 큼 (greater than)
값1 -ge 값2		# 값1이 값2보다 크거나 같음 (greateer or equal)
```

* 파일 검사

```shell
-e 파일명		# 파일이 존재하면 참
-d 파일명		# 파일이 디렉토리면 참
-h 파일명		# 심볼릭 링크 파일이면 참
-f 파일명		# 파일이 일반파일이면 참
-r 파일명		# 파일이 읽기 가능이면 참
-s 파일명		# 파일 크기가 0이 아니면 참
-u 파일명		# 파일이 set-user-id가 설정되면 참
-w 파일명		# 파일이 쓰기 가능이면 참
-x 파일명		# 파일이 실행 가능이면 참
```

* 논리 연산

```shell
조건1 -a 조건2		# AND
조건1 -o 조건2		# OR
조건1 && 조건2		# 양쪽 다 성립
조건1 || 조건2		# 한쪽 또는 양쪽 다 성립
!조건				# 조건이 성립하지 않음
true				# 조건이 언제나 성립
false				# 조건이 언제나 성립하지 않음
```



#### 조건문 문법

* 기본 if/else 구문

```shell
if [ 조건 ]
then
	명령문
else
	명령문
fi

# 또는

if [ 조건 ]; then 명령문; fi
```

* if  `[` 뒤와 `]` 앞에는 반드시 공백이 있어야 함
* `[]` 에서 `&&, ||, <, >` 들이 에러가 날 시, `[[]]`를 사용하면 가능



#### 반복문 문법

* 기본 for 구문

```shell
for 변수 in 변수값1 변수값2 ...
do
	명령문
done
```

* 기본 while 구문

```shell
while [ 조건문 ]
do
	명령문
done
```

